# Keithley SourceMeter Waveform Controller

이 프로그램은 PyQt5 GUI를 기반으로 하여 Keithley 2400 소스미터에 다양한 전압 파형을 생성하고 출력할 수 있도록 도와주는 데스크탑 애플리케이션입니다. 사인, 코사인, 스퀘어, 톱니파, 커스텀 펄스 파형 등을 지원하며, 장비가 연결되어 있지 않은 경우에도 시뮬레이션 모드로 실행 가능합니다.

## 주요 기능

- Keithley 2400 소스미터와 RS-232 통신
- 사인/코사인/스퀘어/톱니파/커스텀 펄스 생성
- 파형의 진폭, 주파수, 위상, 해상도, 반복 횟수 설정 가능
- 파형 미리보기 기능 (Preview)
- 시뮬레이션 모드 지원 (장비 미연결 시에도 작동)
- 커스텀 펄스 테이블 UI 및 스크롤 지원

## 설치 방법

1. Python 3.8 이상 설치
2. 필요한 패키지 설치
   ```bash
   pip install pyvisa pyqt5 matplotlib numpy
   ```

## 실행 방법

```bash
python main.py
```

프로그램이 실행되면 GUI가 나타납니다. 장비가 연결되어 있지 않은 경우 자동으로 시뮬레이션 모드로 전환됩니다.

## 사용법

1. **Waveform Type**: 생성할 파형을 선택합니다 (Sine, Cosine, Square, Sawtooth, Custom).
2. **Amplitude / Frequency / Phase**: 파형의 기본 파라미터를 입력합니다.
3. **Voltage Resolution**: 전압 해상도(V)를 설정합니다. Keithley에 출력 시 반올림됩니다.
4. **Pulse Repeat Count**: 선택한 파형을 몇 번 반복할지 설정합니다.
5. **Custom Pulse**: 직접 시간과 전압을 입력해 파형을 구성할 수 있습니다. 테이블은 스크롤 및 확장 가능하며 마지막 행까지 인식됩니다.
6. **Preview**: 설정된 파형을 시각적으로 확인할 수 있습니다. 반복 주기만큼의 전체 시간도 함께 표시됩니다.
7. **Run on Keithley**: 실제 장비에 파형을 출력합니다 (장비 연결된 경우에만 작동).

## 주의사항

- 장비 연결 시 포트 이름 (`ASRL3::INSTR`) 은 시스템에 따라 다를 수 있으니 확인 후 수정하세요. (NI max 확인 후 조절 필요)
- 커스텀 파형의 경우 시간은 오름차순으로 입력하는 것이 좋습니다.
- 너무 많은 데이터를 너무 빠르게 출력하면 Keithley에서 처리하지 못할 수 있습니다.

## 라이선스

이 프로젝트는 자유롭게 사용 가능합니다.
